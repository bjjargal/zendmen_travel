var Q=(I,R,y)=>new Promise((L,U)=>{var j=w=>{try{$(y.next(w))}catch(O){U(O)}},M=w=>{try{$(y.throw(w))}catch(O){U(O)}},$=w=>w.done?L(w.value):Promise.resolve(w.value).then(j,M);$((y=y.apply(I,R)).next())});import{M as vt,C as ft,B as h,c as g,o as f,e,t as v,u as c,F as z,y as P,d as V,b as a,f as D,m as W,K as _t,r as X,N as gt,p as nt,w as n,D as tt,I as yt}from"./index-DDp1eRUk.js";import{D as lt}from"./destinations-4f1sDCIz.js";import{A as it}from"./Activities-DqFPjuRy.js";import{A as dt}from"./Attraction-hOVnGSQ7.js";import{h as xt,E as bt}from"./html2canvas.esm-BCSDdhLv.js";const ht=vt("ActivitydesStore",()=>({activitiesDes:ft({url:"zendmen_travel.api.get_destination_activities",cache:"ActivityDesCache",auto:!0})})),kt="/assets/zendmen_travel/frontend/assets/pdflogo-CxxR-MyZ.png",wt={class:"min-h-screen bg-background font-sans"},At={class:"text-center font-semibold text-2xl mt-6"},Nt={class:"text-center w-[700px] mx-auto mt-2 text-gray-600"},Dt={class:"grid grid-cols-4 gap-4"},Ut={class:"rounded border text-center p-4"},Tt={class:"text-xl mt-2"},Ct={class:"rounded border text-center p-4"},zt={class:"text-xl mt-2"},St={class:"rounded border text-center p-4"},$t={class:"text-xl mt-2"},Ot={class:"rounded border text-center p-4"},Pt={class:"text-xl mt-2"},It=["src"],Mt={class:"p-6 mt-2 space-y-6"},Bt={class:"flex justify-between items-center"},Ft={class:"rounded p-2 bg-[#030213] text-white leading-none !m-0"},Lt={class:"rounded-full text-sm bg-green-200 py-1 px-3"},jt={class:"text-2xl"},Et={key:0,class:"space-y-3"},Gt={class:"flex items-center gap-2"},Rt={class:"!m-0"},Ht={class:"text-gray-700"},Kt={key:1,class:"bg-gray-200 p-4 rounded-lg space-y-2"},Vt={class:"flex items-center gap-2"},Wt={class:"space-y-1 text-sm text-muted-foreground"},Yt={class:"flex items-center gap-2"},qt={className:"space-y-3"},Zt={className:"grid grid-cols-3 gap-2"},Jt={class:"bg-gray-200 px-3 py-1.5 rounded"},Qt={class:"text-gray-600 ml-1.5"},Xt={class:"space-y-3"},te={class:"grid grid-cols-2 gap-3"},ee={class:"flex gap-3 items-start"},ae={class:"flex-1"},oe={class:"font-medium"},se={class:"text-sm text-gray-600"},ne={class:"border-t space-y-4 pt-4"},le={class:"flex gap-4 justify-between"},ie={className:"flex  items-center gap-2"},de={className:"min-w-0"},ce={className:" truncate"},re={className:"flex items-center gap-2"},ue={className:"min-w-0"},me={className:" truncate"},pe={className:"flex items-center gap-2"},ve={className:"min-w-0"},fe={className:" truncate"},_e={className:"flex items-center gap-2"},ge={className:"min-w-0"},ye={className:" truncate"},xe={className:"flex items-center gap-2"},be={className:"min-w-0"},he={className:" truncate"},ke={key:0,className:"flex items-center gap-2"},we={className:"min-w-0"},Ae={className:" truncate"},Ne={__name:"tourPDF",props:{tour:Object},setup(I){const y=I.tour,{destinations:L}=lt(),{activities:U}=it(),{attractions:j}=dt(),M=x=>{const s=L.data.find(d=>d.name===x);return(s==null?void 0:s.image)||""},$=x=>{const s=L.data.find(d=>d.name===x);return(s==null?void 0:s.description)||""},w=x=>{var s;return((s=y.doc.notes)==null?void 0:s.filter(d=>d.day===x))||[]},O=x=>{var s;return((s=y.doc.attractions)==null?void 0:s.filter(d=>d.day===x))||[]},Y=x=>j.data.find(d=>d.name===x).type,o=x=>y.doc.activities.filter(s=>s.day===x)||[],q=x=>U.data.find(d=>d.name===x).description,H=(x,s,d)=>Object.entries({B:x,L:s,D:d}).filter(([u,E])=>E).map(([u])=>u).join(", ");return(x,s)=>{const d=h("FeatherIcon");return f(),g("div",wt,[s[15]||(s[15]=e("div",{class:"border-b"},[e("img",{src:kt,alt:"Logo",class:"mx-auto w-32 mb-6"})],-1)),e("div",At,v(c(y).doc.tour_name),1),e("p",Nt,v(c(y).doc.sub_title),1),e("div",Dt,[e("div",Ut,[s[0]||(s[0]=e("div",{class:"text-sm text-gray-600"},"Duration",-1)),e("div",Tt,v(c(y).doc.duration)+" Days",1)]),e("div",Ct,[s[1]||(s[1]=e("div",{class:"text-sm text-gray-600"},"Total Distance",-1)),e("div",zt,v(c(y).doc.total_distance)+" km",1)]),e("div",St,[s[2]||(s[2]=e("div",{class:"text-sm text-gray-600"},"Group Size",-1)),e("div",$t,v(c(y).doc.min_people)+"-"+v(c(y).doc.max_people)+" people",1)]),e("div",Ot,[s[3]||(s[3]=e("div",{class:"text-sm text-gray-600"},"Difficulty",-1)),e("div",Pt,v(c(y).doc.difficulty),1)])]),(f(!0),g(z,null,P(c(y).doc.duration,T=>(f(),g("div",null,[(f(!0),g(z,null,P(c(y).doc.accomodation.filter(u=>u.day===T),(u,E)=>(f(),g("div",{key:E,class:"rounded mt-6 overflow-hidden border"},[M(u.destination)?(f(),g("img",{key:0,src:M(u.destination),alt:"",class:"h-80 w-full object-cover"},null,8,It)):V("",!0),e("div",Mt,[e("div",Bt,[e("div",Ft," Day "+v(T),1),e("div",Lt,v(u.difficulty),1)]),e("h2",jt,v(u.title),1),u.destination?(f(),g("div",Et,[e("div",Gt,[a(d,{name:"map-pin",class:"size-4"}),e("h3",Rt,v(u.destination),1)]),e("p",Ht,v($(u.destination)),1)])):V("",!0),w(T).length>0?(f(),g("div",Kt,[e("div",Vt,[a(d,{name:"info",class:"size-4"}),s[4]||(s[4]=e("h4",{class:"text-sm m-0"},"Important Notes",-1))]),e("ul",Wt,[(f(!0),g(z,null,P(w(T),C=>(f(),g("li",Yt,[s[5]||(s[5]=e("span",{class:"text-primary mt-1"},"•",-1)),e("span",null,v(C.note),1)]))),256))])])):V("",!0),e("div",qt,[s[6]||(s[6]=e("h4",null,"Main Attractions",-1)),e("div",Zt,[(f(!0),g(z,null,P(O(T),C=>(f(),g("div",Jt,[D(v(C.attraction)+" ",1),e("span",Qt," • "+v(Y(C.attraction)),1)]))),256))])]),e("div",Xt,[s[7]||(s[7]=e("h4",null,"Activities",-1)),e("div",te,[(f(!0),g(z,null,P(o(T),C=>(f(),g("div",ee,[e("div",ae,[e("div",oe,v(C.activity_name),1),e("div",se,v(q(C.activity_name)),1)])]))),256))])]),e("div",ne,[s[14]||(s[14]=e("h4",{class:"text-sm"},"Travel & Logistics",-1)),e("div",le,[e("div",ie,[a(d,{name:"navigation",class:"size-4"}),e("div",de,[s[8]||(s[8]=e("div",{className:"text-sm text-gray-600"},"Distance",-1)),e("div",ce,v(u.distance)+" km",1)])]),e("div",re,[a(d,{name:"clock",class:"size-4"}),e("div",ue,[s[9]||(s[9]=e("div",{className:"text-sm text-gray-600"},"Drive Time",-1)),e("div",me,v(u.drive_time)+" min",1)])]),e("div",pe,[a(d,{name:"map",class:"size-4"}),e("div",ve,[s[10]||(s[10]=e("div",{className:"text-sm text-gray-600"},"Terrain",-1)),e("div",fe,v(u.terrain),1)])]),e("div",_e,[a(d,{name:"trending-up",class:"size-4"}),e("div",ge,[s[11]||(s[11]=e("div",{className:"text-sm text-gray-600"},"Altitude",-1)),e("div",ye,v(u.aButtonltitude)+" km",1)])]),e("div",xe,[a(d,{name:"home",class:"size-4"}),e("div",be,[s[12]||(s[12]=e("div",{className:"text-sm text-gray-600"},"Accommodation",-1)),e("div",he,v(u.accomodation),1)])]),H(u.breakfast,u.lunch,u.dinner)?(f(),g("div",ke,[a(d,{name:"coffee",class:"size-4"}),e("div",we,[s[13]||(s[13]=e("div",{className:"text-sm text-gray-600"},"Meals",-1)),e("div",Ae,v(H(u.breakfast,u.lunch,u.dinner)),1)])])):V("",!0)])])])]))),128))]))),256))])}}},De={key:1,class:"w-full h-full bg-white flex"},Ue={class:"w-[25%] h-full p-2 flex flex-col gap-1 border-r"},Te={class:"flex-1 p-2"},Ce={key:1,class:"flex gap-2"},Me={__name:"Tour",props:{name:{type:String,required:!0}},setup(I){const R=I,{destinations:y}=lt(),{activities:L}=it(),{activitiesDes:U}=ht(),{attractions:j}=dt(),M=W(()=>{var l;return((l=y==null?void 0:y.data)==null?void 0:l.map(t=>({value:t.name,label:t.destination_name})))||[]}),$=[{title:"Note",dataIndex:"note"},{title:"Action",dataIndex:"Action",key:"Action"}],w=[{value:"Easy"},{value:"Moderate"},{value:"Challenging"}],O=[{value:"Camping"},{value:"Hotel"},{value:"Ger Camp"}],Y=[{value:"Paved roads"},{value:"Paved & gravel"},{value:"Mixed paved & dirt"},{value:"Desert tracks"},{value:"Mountain roads"}],o=_t({doctype:"Tour",name:R.name,auto:!0});console.log(U.data);const q=l=>(U==null?void 0:U.data[l])||[],H=l=>j.data.filter(t=>t.destination===l).map(t=>t.name),x=W({get(){var t;return(((t=o.doc.attractions)==null?void 0:t.filter(b=>b.day===d.value))||[]).map(b=>b.attraction)},set(l){Array.isArray(o.doc.attractions)||(o.doc.attractions=[]);const t=d.value,k=o.doc.attractions.filter(_=>_.day===t).map(_=>_.attraction);l.forEach(_=>{k.includes(_)||o.doc.attractions.push({day:t,attraction:_,parent:o.doc.name,parenttype:"Tour",parentfield:"attractions"})}),o.doc.attractions=o.doc.attractions.filter(_=>_.day!==t?!0:l.includes(_.attraction))}}),s=W({get(){var t;return(((t=o.doc.activities)==null?void 0:t.filter(b=>b.day===d.value))||[]).map(b=>b.activity_name)},set(l){Array.isArray(o.doc.activities)||(o.doc.activities=[]);const t=d.value,k=o.doc.activities.filter(_=>_.day===t).map(_=>_.activity_name);l.forEach(_=>{k.includes(_)||o.doc.activities.push({day:t,activity_name:_,parent:o.doc.name,parenttype:"Tour",parentfield:"activities"})}),o.doc.activities=o.doc.activities.filter(_=>_.day!==t?!0:l.includes(_.activity_name))}}),d=X(1);gt(()=>{var l;return(l=o==null?void 0:o.doc)==null?void 0:l.duration},l=>{for(let t=1;t<=l;t++)o.doc.accomodation.some(k=>k.day===t)||o.doc.accomodation.push({day:t,title:"",destination:null,difficulty:null,accomodation:null,distance:null,drive_time:null,terrain:null,altitude:null,parent:o.doc.name,parenttype:"Tour",parentfield:"accomodation",doctype:"Tour Accomodation"})},{immediate:!0});const T=W(()=>{var l;return((l=o.doc.notes)==null?void 0:l.filter(t=>t.day===d.value))||[]}),u=()=>{o.doc.notes.push({day:d.value,note:"",parent:o.doc.name,parenttype:"Tour",parentfield:"notes",doctype:"Tour Note"})},E=l=>{!o.doc.notes||!Array.isArray(o.doc.notes)||(l.name?o.doc.notes=o.doc.notes.filter(t=>t.name!==l.name):o.doc.notes=o.doc.notes.filter(t=>t!==l),tt.success("Note deleted"))},C=()=>Q(this,null,function*(){try{o.save.submit(),tt.success("Successflly saved",2)}catch(l){tt.error(l.message,2)}}),Z=X(!1),et=X(null),ct=()=>Q(this,null,function*(){try{const l=et.value;if(!l){console.error("No element found for PDF");return}yield yt(),yield new Promise(K=>setTimeout(K,300));const t=yield xt(l,{scale:2,useCORS:!0,allowTaint:!0,scrollY:-window.scrollY,backgroundColor:"#ffffff"}),b=t.toDataURL("image/png"),k=new bt("p","pt","a4"),_=k.internal.pageSize.getWidth(),G=k.internal.pageSize.getHeight(),r=40,B=_-r*2,A=t.height*B/t.width;let N=A,F=r;for(k.addImage(b,"PNG",r,F,B,A),N-=G-r*2;N>0;)k.addPage(),F=N-A+r,k.addImage(b,"PNG",r,F,B,A),N-=G-r*2;k.save(`${o.doc.tour_name||"Tour"}.pdf`)}catch(l){console.error("❌ PDF generation failed:",l)}});return(l,t)=>{var ot,st;const b=h("a-button"),k=h("a-page-header"),_=h("a-spin"),G=h("a-input"),r=h("a-form-item"),B=h("a-textarea"),A=h("a-input-number"),N=h("a-select"),F=h("a-space"),K=h("a-form"),J=h("a-checkbox"),at=h("a-checkbox-group"),rt=h("a-table"),ut=h("a-tab-pane"),mt=h("a-tabs"),pt=h("a-modal");return f(),g(z,null,[a(k,{class:"!p-0 !mb-2",title:((st=(ot=c(o))==null?void 0:ot.doc)==null?void 0:st.tour_name)||"tour",onBack:t[2]||(t[2]=()=>l.$router.go(-1))},{extra:n(()=>{var p,i;return[a(b,{onClick:t[0]||(t[0]=S=>Z.value=!0),loading:!1,type:"dashed"},{default:n(()=>[...t[14]||(t[14]=[D(" show pdf ",-1)])]),_:1}),a(b,{onClick:t[1]||(t[1]=S=>C()),loading:!!((i=(p=c(o))==null?void 0:p.save)!=null&&i.loading),type:"primary"},{default:n(()=>[...t[15]||(t[15]=[D(" Save ",-1)])]),_:1},8,["loading"])]}),_:1},8,["title"]),c(o).get.loading?(f(),nt(_,{key:0},{default:n(()=>[...t[16]||(t[16]=[D("Loading",-1)])]),_:1})):(f(),g("div",De,[e("div",Ue,[a(K,{layout:"vertical",class:"w-full"},{default:n(()=>[a(r,{colon:!1,labelAlign:"left",label:"Tour name"},{default:n(()=>[a(G,{type:"text",value:c(o).doc.tour_name,"onUpdate:value":t[3]||(t[3]=p=>c(o).doc.tour_name=p)},null,8,["value"])]),_:1}),a(r,{colon:!1,labelAlign:"left",label:"Subtitle"},{default:n(()=>[a(B,{value:c(o).doc.sub_title,"onUpdate:value":t[4]||(t[4]=p=>c(o).doc.sub_title=p),rows:6},null,8,["value"])]),_:1}),a(r,{colon:!1,labelAlign:"left",label:"Duration"},{default:n(()=>[a(A,{class:"!w-full",value:c(o).doc.duration,"onUpdate:value":t[5]||(t[5]=p=>c(o).doc.duration=p),min:1,max:20,"addon-after":"Days"},null,8,["value"])]),_:1}),a(r,{colon:!1,labelAlign:"left",label:"Difficulty"},{default:n(()=>[a(N,{options:[{value:"Easy-Moderate"}],value:c(o).doc.difficulty,"onUpdate:value":t[6]||(t[6]=p=>c(o).doc.difficulty=p)},null,8,["value"])]),_:1}),a(r,{colon:!1,labelAlign:"left",label:"Group size"},{default:n(()=>[a(F,null,{default:n(()=>[a(A,{value:c(o).doc.min_people,"onUpdate:value":t[7]||(t[7]=p=>c(o).doc.min_people=p),min:1,max:20,"addon-before":"min"},null,8,["value"]),a(A,{value:c(o).doc.max_people,"onUpdate:value":t[8]||(t[8]=p=>c(o).doc.max_people=p),min:1,max:20,"addon-before":"max"},null,8,["value"])]),_:1})]),_:1}),a(r,{colon:!1,labelAlign:"left",label:"Total Distance"},{default:n(()=>[a(A,{value:c(o).doc.total_distance,"onUpdate:value":t[9]||(t[9]=p=>c(o).doc.total_distance=p),"addon-after":"km",class:"!w-full"},null,8,["value"])]),_:1})]),_:1})]),e("div",Te,[a(K,{layout:"vertical",class:""},{default:n(()=>[a(r,{colon:!1,labelAlign:"left"},{default:n(()=>[a(mt,{class:"",activeKey:d.value,"onUpdate:activeKey":t[12]||(t[12]=p=>d.value=p),"tab-position":"top",type:"card"},{default:n(()=>[(f(!0),g(z,null,P(c(o).doc.duration,p=>(f(),nt(ut,{key:p,tab:`Day ${p}`},{default:n(()=>[(f(!0),g(z,null,P(c(o).doc.accomodation.filter(i=>i.day===p),(i,S)=>(f(),g("div",{key:S,class:"!grid grid-cols-4 gap-2"},[a(r,{label:"title"},{default:n(()=>[a(G,{type:"text",value:i.title,"onUpdate:value":m=>i.title=m},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Destination"},{default:n(()=>[a(N,{options:M.value,value:i.destination,"onUpdate:value":m=>i.destination=m,"allow-clear":""},null,8,["options","value","onUpdate:value"])]),_:2},1024),a(r,{label:"Difficulty"},{default:n(()=>[a(N,{options:w,value:i.difficulty,"onUpdate:value":m=>i.difficulty=m,"allow-clear":""},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Accomodation"},{default:n(()=>[a(N,{options:O,value:i.accomodation,"onUpdate:value":m=>i.accomodation=m,"allow-clear":""},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Distance"},{default:n(()=>[a(A,{value:i.distance,"onUpdate:value":m=>i.distance=m,"allow-clear":"",class:"!w-full","addon-after":"km"},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Drive Time"},{default:n(()=>[a(A,{value:i.drive_time,"onUpdate:value":m=>i.drive_time=m,"allow-clear":"",class:"!w-full","addon-after":"hours"},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Terrain"},{default:n(()=>[a(N,{options:Y,value:i.terrain,"onUpdate:value":m=>i.terrain=m,"allow-clear":""},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Altitude"},{default:n(()=>[a(A,{value:i.altitude,"onUpdate:value":m=>i.altitude=m,"allow-clear":"",class:"!w-full","addon-after":"km"},null,8,["value","onUpdate:value"])]),_:2},1024),a(r,{label:"Meals",class:""},{default:n(()=>[a(F,{direction:"vertical"},{default:n(()=>[a(J,{checked:!!i.breakfast,"onUpdate:checked":m=>i.breakfast=!i.breakfast},{default:n(()=>[...t[17]||(t[17]=[D("Breakfast",-1)])]),_:1},8,["checked","onUpdate:checked"]),a(J,{checked:!!i.lunch,"onUpdate:checked":m=>i.lunch=!i.lunch},{default:n(()=>[...t[18]||(t[18]=[D("Lunch",-1)])]),_:1},8,["checked","onUpdate:checked"]),a(J,{checked:!!i.dinner,"onUpdate:checked":m=>i.dinner=!i.dinner},{default:n(()=>[...t[19]||(t[19]=[D("Dinner",-1)])]),_:1},8,["checked","onUpdate:checked"])]),_:2},1024)]),_:2},1024),a(r,{label:"Activities",class:""},{default:n(()=>[a(at,{value:s.value,"onUpdate:value":t[10]||(t[10]=m=>s.value=m),options:q(i.destination)},null,8,["value","options"])]),_:2},1024),a(r,{label:"Attractions",class:""},{default:n(()=>[a(at,{value:x.value,"onUpdate:value":t[11]||(t[11]=m=>x.value=m),options:H(i.destination)},null,8,["value","options"])]),_:2},1024)]))),128)),a(r,{label:"Notes"},{default:n(()=>[a(rt,{columns:$,pagination:!1,"data-source":T.value,size:"small"},{bodyCell:n(({column:i,record:S})=>[i.dataIndex==="note"?(f(),g(z,{key:0},[a(B,{rows:1,value:S.note,"onUpdate:value":m=>S.note=m},null,8,["value","onUpdate:value"]),D(" "+v(S.node),1)],64)):(f(),g("div",Ce,[a(b,{onClick:m=>E(S),danger:"",size:"small"},{default:n(()=>[...t[20]||(t[20]=[D("Delete",-1)])]),_:1},8,["onClick"])]))]),_:1},8,["data-source"]),a(b,{class:"mt-2",onClick:u},{default:n(()=>[...t[21]||(t[21]=[D("add note",-1)])]),_:1})]),_:1})]),_:2},1032,["tab"]))),128))]),_:1},8,["activeKey"])]),_:1})]),_:1})])])),a(pt,{open:Z.value,"onUpdate:open":t[13]||(t[13]=p=>Z.value=p),title:"",width:"60%",onOk:ct},{default:n(()=>[e("div",{ref_key:"pdfContent",ref:et},[a(Ne,{tour:c(o)},null,8,["tour"])],512)]),_:1},8,["open"])],64)}}};export{Me as default};
//# sourceMappingURL=Tour-ClKS1aQf.js.map
